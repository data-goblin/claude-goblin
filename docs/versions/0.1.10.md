# Version 0.1.10 - CLI Restructure & Devcontainer

Released: December 14, 2025

## Overview

Major release restructuring the CLI to nested subcommands, adding devcontainer support for safe execution, and temporarily disabling limits tracking due to upstream changes.

## New Features

### Devcontainer Support

New devcontainer configuration for running Claude Code with `--dangerously-skip-permissions` safely:

```bash
ccg setup container
```

Creates `.devcontainer/` with:
- Docker container with iptables/ipset firewall
- Whitelisted domains only: Anthropic, GitHub, PyPI, npm, MS Learn, MDN
- All other network access blocked

### Automatic Backups

Remove operations now create timestamped backups automatically:

```bash
ccg remove usage    # Creates usage_history.YYYYMMDD_HHMMSS.db.bak
ccg remove hooks    # Creates settings.YYYYMMDD_HHMMSS.json.bak
```

### Reproducible Builds

Added `uv.lock` for deterministic dependency resolution.

## Breaking Changes

### CLI Restructured to Nested Subcommands

| Old Command | New Command |
|-------------|-------------|
| `ccg setup-hooks` | `ccg setup hooks` |
| `ccg setup-container` | `ccg setup container` |
| `ccg remove-hooks` | `ccg remove hooks` |
| `ccg delete-usage` | `ccg remove usage` |
| `ccg update-usage` | `ccg update usage` |
| `ccg restore-backup` | `ccg restore usage` |

Old commands will no longer work.

### Export Filename Simplified

Export now uses `claude-usage.png` instead of `claude-usage-<timestamp>.png`.

## Deprecations

### Limits Tracking Temporarily Disabled

Claude Code's `/usage` output format changed, breaking the PTY-based parsing. Affected commands:

| Command | Status |
|---------|--------|
| `ccg limits` | Shows "temporarily unavailable" |
| `ccg status-bar` | Shows "temporarily unavailable" |
| `ccg export --show limits` | Uses historical data only |

**Token tracking continues to work normally.**

Workaround: Run `claude /usage` directly to view limits.

## Technical Changes

- Migrated to Typer sub-applications for nested command structure
- `capture_limits()` now returns error dict instead of attempting PTY capture
- All commands handle limits errors gracefully
- Backup logic added to `remove` subcommands
- Hook recognition updated for new command format

## Upgrading

```bash
uv pip install --upgrade claude-goblin
# or
pip install --upgrade claude-goblin
```

Update any scripts or aliases using old command format.

## Files Modified

- `src/cli.py` - Restructured with sub-applications
- `src/commands/setup/` - New setup subcommand module
- `src/commands/remove/` - New remove subcommand module
- `src/commands/update/` - New update subcommand module
- `src/commands/restore/` - New restore subcommand module
- `src/commands/limits.py` - Disabled with graceful error
- `src/commands/status_bar.py` - Disabled with graceful error
- `src/commands/export.py` - Added limits warning
- `src/hooks/manager.py` - Added backup before hook removal
- `.devcontainer/` - New devcontainer configuration
- `uv.lock` - New lockfile for reproducible builds
